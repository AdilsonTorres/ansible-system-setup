$copy_pub_key = <<EOF
    # copy a predefined key for easier ssh access
    KEY_STRING='#{File.read("#{Dir.home}/.ssh/custom_vagrant_key.pub")}'
    grep --quiet custom_vagrant_key ~/.ssh/authorized_keys
    if [ $? -eq 1 ]; then
        echo 'Adding "custom_vagrant_key" to authorized keys'
        echo "$KEY_STRING" >> ~/.ssh/authorized_keys
    else
        echo '"custom_vagrant_key" already in authorized keys'
    fi
EOF

$playbook_path = ".config/ansible-system-setup/provision-vagrant-vms.yml"

Vagrant.configure(2) do |config|
    config.vm.provision "shell", inline: $copy_pub_key, privileged: false
    config.vm.provision "ansible" do |ans|
        ans.playbook = "{{ ansible_env.HOME }}/" + $playbook_path
    end
end
