- name: create XDG directories
  file:
    path: "{{ ansible_env.HOME }}/media/{{ item }}"
    state: directory
  with_items:
    - wymiana
    - muzyka
    - filmy
    - obrazy
  when: inventory_hostname in groups.personal_computers

- name: update user-dirs.dirs
  copy:
    src: "{{ user_dirs_file }}"
    dest: ~/.config/user-dirs.dirs

- name: initialize file manager bookmarks
  copy:
    src: "{{ fm_bookmarks_file }}"
    dest: ~/.config/gtk-3.0/bookmarks
    force: no

- name: remove unneeded directories
  shell: rmdir "{{ ansible_env.HOME }}/{{ item }}"
  with_items:
    - Desktop
    - Documents
    - Downloads
    - Music
    - Pictures
    - Public
    - Templates
    - Videos
    - Pulpit
    - Dokumenty
    - Pobrane
    - Muzyka
    - Obrazy
    - Publiczne
    - Szablony
    - Wideo
  register: task_result
  changed_when: task_result.stderr == ''
  failed_when: '"Directory not empty" in task_result.stderr'

- name: set Terminator as default system terminal
  shell: >
    gsettings get org.cinnamon.desktop.default-applications.terminal exec;
    gsettings set org.cinnamon.desktop.default-applications.terminal exec 'terminator'
  register: previous_default
  changed_when: '"terminator" not in previous_default.stdout'
